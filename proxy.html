<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ArrowUBG Proxy</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      display: flex;
      flex-direction: column;
      height: 100vh;
      background-color: #0a1d37; /* ArrowUBG deep navy */
    }
    #proxy-iframe {
      flex-grow: 1;
      width: 100%;
      border: none;
      display: none;
    }
    .icon-btn {
      background: transparent;
      border: none;
      color: #4de6f2;
      cursor: pointer;
      padding: 6px;
      border-radius: 6px;
      transition: background 0.2s;
      font-size: 18px;
      line-height: 1;
    }
    .icon-btn:hover {
      background: rgba(23,217,234,0.2);
    }
  </style>
</head>
<body>

  <!-- Header with search -->
  <header class="bg-[#001a2e] p-3 shadow-lg flex justify-between items-center z-10 border-b border-cyan-400">
    <div class="flex items-center space-x-2">
      <input id="search-input" type="text" placeholder="Search or enter URL..."
        class="bg-[#0a1d37] text-cyan-200 px-3 py-2 rounded-lg w-64 sm:w-96 focus:outline-none border border-cyan-400">
      <select id="engine-select" class="bg-[#0a1d37] text-cyan-200 px-2 py-2 rounded-lg border border-cyan-400">
        <option value="google">Google</option>
        <option value="bing">Bing</option>
        <option value="duckduckgo">DuckDuckGo</option>
      </select>
      <button id="search-button" class="bg-cyan-500 hover:bg-cyan-400 text-[#0a1d37] font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">
        Search
      </button>
    </div>
    <div class="flex items-center space-x-2">
      <button id="close-button" class="icon-btn" title="Close">✕</button>
      <button id="fullscreen-button" class="icon-btn" title="Fullscreen">⛶</button>
    </div>
  </header>

  <!-- Loader -->
  <div id="loading-indicator" class="flex-grow flex items-center justify-center text-cyan-200 text-xl">
    <svg class="animate-spin -ml-1 mr-3 h-8 w-8 text-cyan-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
      <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
      <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
    </svg>
    Ready to search...
  </div>

  <!-- Iframe -->
  <iframe id="proxy-iframe"></iframe>

  <script>
    const searchInput = document.getElementById('search-input');
    const engineSelect = document.getElementById('engine-select');
    const searchButton = document.getElementById('search-button');
    const iframe = document.getElementById('proxy-iframe');
    const loadingIndicator = document.getElementById('loading-indicator');
    const closeButton = document.getElementById('close-button');
    const fullscreenButton = document.getElementById('fullscreen-button');

    function buildSearchUrl(query, engine) {
      if (query.startsWith("http://") || query.startsWith("https://")) {
        return query; // direct URL
      }
      switch(engine) {
        case "google":
          return "https://www.google.com/search?q=" + encodeURIComponent(query);
        case "bing":
          return "https://www.bing.com/search?q=" + encodeURIComponent(query);
        case "duckduckgo":
          return "https://duckduckgo.com/?q=" + encodeURIComponent(query);
        default:
          return "https://www.google.com/search?q=" + encodeURIComponent(query);
      }
    }

    function performSearch() {
      const query = searchInput.value.trim();
      if (!query) return;
      const engine = engineSelect.value;
      const url = buildSearchUrl(query, engine);

      loadingIndicator.innerHTML = "Loading...";
      loadingIndicator.classList.remove("hidden");
      iframe.style.display = "none";

      iframe.src = url;
      iframe.onload = () => {
        loadingIndicator.classList.add("hidden");
        iframe.style.display = "block";
      };
      iframe.onerror = () => {
        loadingIndicator.innerHTML = '<span class="text-red-400">Error loading site.</span>';
      };
    }

    searchButton.addEventListener("click", performSearch);
    searchInput.addEventListener("keydown", e => {
      if (e.key === "Enter") performSearch();
    });

    closeButton.addEventListener("click", () => {
      iframe.src = "";
      iframe.style.display = "none";
      loadingIndicator.classList.remove("hidden");
      loadingIndicator.innerHTML = "Ready to search...";
    });

    fullscreenButton.addEventListener("click", () => {
      if (!document.fullscreenElement) {
        iframe.requestFullscreen().catch(err => console.log(err));
      } else {
        document.exitFullscreen();
      }
    });
  </script>
</body>
</html>
